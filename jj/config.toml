"$schema" = "https://jj-vcs.github.io/jj/latest/config-schema.json"

[user]
name = "Oscar SÃ¶derlund"
email = "odsod@users.noreply.github.com"

[templates]
git_push_bookmark = '"odsod/push-" ++ change_id.short()'
draft_commit_description = '''
concat(
  builtin_draft_commit_description,
  "\nJJ: ignore-rest\n",
  diff.git(),
)
'''

[aliases]
rebase-all = ["rebase", "-s", "(::trunk())+ & mutable()", "-d", "trunk()"]
# Optional per-repo migration: `jj bookmark forget main` to drop local main bookmark.
# Sync remote-tracking refs from origin.
sync = ["util", "exec", "--", "jj-workflow", "sync"]
# Prune merged odsod/push-* bookmarks that are already contained in main@origin.
clean = ["util", "exec", "--", "jj-workflow", "clean"]
# Start a new empty working commit on top of latest main@origin.
start = ["util", "exec", "--", "jj-workflow", "start"]
# Run preflight only: fetch, mutable divergence check, and base-on-main check.
pr-check = ["util", "exec", "--", "jj-workflow", "pr-check"]
# Create a new PR for the current change-id bookmark after passing preflight.
pr = ["util", "exec", "--", "jj-workflow", "pr"]
# Update an existing PR for the current change-id bookmark after passing preflight.
pr-update = ["util", "exec", "--", "jj-workflow", "pr-update"]
delta = ["diff", "--config", "ui.diff-formatter=\":git\"", "--config", "ui.pager=\"delta\""]

[revset-aliases]
upstream_work = "@ | ancestors(remote_bookmarks().., 2) | trunk()"

[revsets]
# Default view: current work + your bookmarked branches + latest upstream main context.
log = "present(@ | ancestors(@, 4) | (bookmarks() & mine()) | main@origin | descendants(main@origin, 4))"

[ui]
editor = ["nvim"]
default-command = ["log"]
show-diff-on-description-edit = true
pager = "delta"
diff-formatter = "difft"

[merge-tools.difft]
program = "difft"
diff-args = ["--color=always", "$left", "$right"]
